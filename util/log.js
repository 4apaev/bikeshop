import { inspect } from 'util'
import { Writable } from 'stream'
import { BIKESHOP_DEBUG as DEBUG } from '../config/config.js'

export default function Log(s) {
  if (s?.raw)
    write.apply(process.stdout, arguments)
  else
    console.log.apply(console, arguments)
}

Log.debug = debug
Log.write = write
Log.table = console.table
Log.trace = console.trace
Log.error = console.error

export function write(s, ...a) {
  const soc = Writable[ Symbol.hasInstance ](this) ? this : process.stdout
  soc.write(s.raw[ 0 ], 'utf-8')
  for (let i = 0; i < a.length;)
    soc.write(inspect(a[ i++ ]) + s.raw[ i ], 'utf-8')
  soc.write('\n')
}

const colors = [
  'ğŸ”´',   'ğŸŸ ',   'ğŸŸ¡',   'ğŸŸ¢',  'ğŸ”µ',   'ğŸŸ£',   'âš«ï¸',  'âšªï¸',   'ğŸŸ¤',
  'ğŸ”´ğŸ”´', 'ğŸŸ ğŸ”´', 'ğŸŸ¡ğŸ”´', 'ğŸŸ¢ğŸ”´', 'ğŸ”µğŸ”´', 'ğŸŸ£ğŸ”´', 'âš«ï¸ğŸ”´', 'âšªï¸ğŸ”´', 'ğŸŸ¤ğŸ”´',
  'ğŸ”´ğŸŸ ', 'ğŸŸ ğŸŸ ', 'ğŸŸ¡ğŸŸ ', 'ğŸŸ¢ğŸŸ ', 'ğŸ”µğŸŸ ', 'ğŸŸ£ğŸŸ ', 'âš«ï¸ğŸŸ ', 'âšªï¸ğŸŸ ', 'ğŸŸ¤ğŸŸ ',
  'ğŸ”´ğŸŸ¡', 'ğŸŸ ğŸŸ¡', 'ğŸŸ¡ğŸŸ¡', 'ğŸŸ¢ğŸŸ¡', 'ğŸ”µğŸŸ¡', 'ğŸŸ£ğŸŸ¡', 'âš«ï¸ğŸŸ¡', 'âšªï¸ğŸŸ¡', 'ğŸŸ¤ğŸŸ¡',
  'ğŸ”´ğŸŸ¢', 'ğŸŸ ğŸŸ¢', 'ğŸŸ¡ğŸŸ¢', 'ğŸŸ¢ğŸŸ¢', 'ğŸ”µğŸŸ¢', 'ğŸŸ£ğŸŸ¢', 'âš«ï¸ğŸŸ¢', 'âšªï¸ğŸŸ¢', 'ğŸŸ¤ğŸŸ¢',
  'ğŸ”´ğŸ”µ', 'ğŸŸ ğŸ”µ', 'ğŸŸ¡ğŸ”µ', 'ğŸŸ¢ğŸ”µ', 'ğŸ”µğŸ”µ', 'ğŸŸ£ğŸ”µ', 'âš«ï¸ğŸ”µ', 'âšªï¸ğŸ”µ', 'ğŸŸ¤ğŸ”µ',
  'ğŸ”´ğŸŸ£', 'ğŸŸ ğŸŸ£', 'ğŸŸ¡ğŸŸ£', 'ğŸŸ¢ğŸŸ£', 'ğŸ”µğŸŸ£', 'ğŸŸ£ğŸŸ£', 'âš«ï¸ğŸŸ£', 'âšªï¸ğŸŸ£', 'ğŸŸ¤ğŸŸ£',
  'ğŸ”´âš«ï¸', 'ğŸŸ âš«ï¸', 'ğŸŸ¡âš«ï¸', 'ğŸŸ¢âš«ï¸', 'ğŸ”µâš«ï¸', 'ğŸŸ£âš«ï¸', 'âš«ï¸âš«ï¸', 'âšªï¸âš«ï¸', 'ğŸŸ¤âš«ï¸',
  'ğŸ”´âšªï¸', 'ğŸŸ âšªï¸', 'ğŸŸ¡âšªï¸', 'ğŸŸ¢âšªï¸', 'ğŸ”µâšªï¸', 'ğŸŸ£âšªï¸', 'âš«ï¸âšªï¸', 'âšªï¸âšªï¸', 'ğŸŸ¤âšªï¸',
  'ğŸ”´ğŸŸ¤', 'ğŸŸ ğŸŸ¤', 'ğŸŸ¡ğŸŸ¤', 'ğŸŸ¢ğŸŸ¤', 'ğŸ”µğŸŸ¤', 'ğŸŸ£ğŸŸ¤', 'âš«ï¸ğŸŸ¤', 'âšªï¸ğŸŸ¤', 'ğŸŸ¤ğŸŸ¤',
]
colors.i = 0
// â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯ DEBUG:LOG â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯
//                ${ DEBUG }
// â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®â®

write`
============ DEBUG:LOG ============
    ${ DEBUG }
===================================
`
export function debug(prefix) {

  const head = `[${  colors[ colors.i++ % colors.length ] } ${ prefix }] `
  const ok = DEBUG.includes(prefix) || DEBUG == '*'

  write`[ DEBUG:LOG ] ${ ok ? 'âœ…' : 'â›”ï¸' } ${ head }`

  // write.call(process.stdout, '========== DEBUG LOG', DEBUG, ok ? 'âœ…' : 'â›”ï¸', prefix)

  const fn = ok
    ? (...a) => {
      process.stdout.write(head, 'utf-8')
      Log.apply(Log, a)
    }
    : () => {}

  return fn
}

/*
  'ğŸŸ¥',  'ğŸŸ§',   'ğŸŸ¨',   'ğŸŸ©',  'ğŸŸ¦',   'ğŸŸª',   'â¬›ï¸',  'â¬œï¸',   'ğŸŸ«',
  'ğŸŸ¥ğŸŸ¥', 'ğŸŸ§ğŸŸ¥', 'ğŸŸ¨ğŸŸ¥', 'ğŸŸ©ğŸŸ¥', 'ğŸŸ¦ğŸŸ¥', 'ğŸŸªğŸŸ¥', 'â¬›ï¸ğŸŸ¥', 'â¬œï¸ğŸŸ¥', 'ğŸŸ«ğŸŸ¥',
  'ğŸŸ¥ğŸŸ§', 'ğŸŸ§ğŸŸ§', 'ğŸŸ¨ğŸŸ§', 'ğŸŸ©ğŸŸ§', 'ğŸŸ¦ğŸŸ§', 'ğŸŸªğŸŸ§', 'â¬›ï¸ğŸŸ§', 'â¬œï¸ğŸŸ§', 'ğŸŸ«ğŸŸ§',
  'ğŸŸ¥ğŸŸ¨', 'ğŸŸ§ğŸŸ¨', 'ğŸŸ¨ğŸŸ¨', 'ğŸŸ©ğŸŸ¨', 'ğŸŸ¦ğŸŸ¨', 'ğŸŸªğŸŸ¨', 'â¬›ï¸ğŸŸ¨', 'â¬œï¸ğŸŸ¨', 'ğŸŸ«ğŸŸ¨',
  'ğŸŸ¥ğŸŸ©', 'ğŸŸ§ğŸŸ©', 'ğŸŸ¨ğŸŸ©', 'ğŸŸ©ğŸŸ©', 'ğŸŸ¦ğŸŸ©', 'ğŸŸªğŸŸ©', 'â¬›ï¸ğŸŸ©', 'â¬œï¸ğŸŸ©', 'ğŸŸ«ğŸŸ©',
  'ğŸŸ¥ğŸŸ¦', 'ğŸŸ§ğŸŸ¦', 'ğŸŸ¨ğŸŸ¦', 'ğŸŸ©ğŸŸ¦', 'ğŸŸ¦ğŸŸ¦', 'ğŸŸªğŸŸ¦', 'â¬›ï¸ğŸŸ¦', 'â¬œï¸ğŸŸ¦', 'ğŸŸ«ğŸŸ¦',
  'ğŸŸ¥ğŸŸª', 'ğŸŸ§ğŸŸª', 'ğŸŸ¨ğŸŸª', 'ğŸŸ©ğŸŸª', 'ğŸŸ¦ğŸŸª', 'ğŸŸªğŸŸª', 'â¬›ï¸ğŸŸª', 'â¬œï¸ğŸŸª', 'ğŸŸ«ğŸŸª',
  'ğŸŸ¥â¬›ï¸', 'ğŸŸ§â¬›ï¸', 'ğŸŸ¨â¬›ï¸', 'ğŸŸ©â¬›ï¸', 'ğŸŸ¦â¬›ï¸', 'ğŸŸªâ¬›ï¸', 'â¬›ï¸â¬›ï¸', 'â¬œï¸â¬›ï¸', 'ğŸŸ«â¬›ï¸',
  'ğŸŸ¥â¬œï¸', 'ğŸŸ§â¬œï¸', 'ğŸŸ¨â¬œï¸', 'ğŸŸ©â¬œï¸', 'ğŸŸ¦â¬œï¸', 'ğŸŸªâ¬œï¸', 'â¬›ï¸â¬œï¸', 'â¬œï¸â¬œï¸', 'ğŸŸ«â¬œï¸',
  'ğŸŸ¥ğŸŸ«', 'ğŸŸ§ğŸŸ«', 'ğŸŸ¨ğŸŸ«', 'ğŸŸ©ğŸŸ«', 'ğŸŸ¦ğŸŸ«', 'ğŸŸªğŸŸ«', 'â¬›ï¸ğŸŸ«', 'â¬œï¸ğŸŸ«', 'ğŸŸ«ğŸŸ«',
*/

